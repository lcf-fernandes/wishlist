{"1749838007074":{"actionType":"saveAll","createdAt":"1749838007074","actionID":"1749838007074","userID":"#TEMP","path":"system.capsules.1e141b4f-1812-4c0f-8f86-f7ac81098c6c.capsUseCodeInfo.capsUseInputs.sss_custom_caps-0.capsIptTxtValue","oldValue":"() => {\n  const path1 = \"scA0.gameList\";\n  const path2 = \"sc.A1.results\";\n  const allVal = tools.getCtData(path1);\n\n  const { rendTrib, desMed, irRet, edu, prev, dep } = allVal;\nconsole.log({irRet});\n\n  const toNum = (str) => parseFloat((str || \"0\").replace(\",\", \".\"));\n\n  const totalDep = toNum(dep) * 2400;\n  const totalDed = toNum(desMed) + toNum(edu) + toNum(prev) + totalDep;\n  const calcBase = Math.max(0, toNum(rendTrib) - totalDed);\n\n  const tabelaIR = tools.getCtData('all.tabelaIR');\n  const faixaEncontrada = tabelaIR.find(faixa => calcBase <= faixa.limite);\n\nconst irDevido = Math.max(0, (calcBase * (faixaEncontrada.aliquota / 100)) - faixaEncontrada.deducao);\n\nconst resultado = toNum(irRet) - irDevido;\n\nlet finalResult;\nif (resultado >= 0) {\nconst res1 = \"Restituição: R$\" + resultado.toFixed(2);\n  console.log( res1 );\nfinalResult = res1;\n} else {\n  const res2 = \"Imposto a pagar: R$\" +  Math.abs(resultado).toFixed(2);\n  console.log( res2 );\nfinalResult = res2;\n}\nconsole.log({finalResult});\n\n const pass1 = { keyPath: [path2], value: [finalResult] };\n tools.functions.setVar({ args: '', pass: pass1 });\n}","newValue":"() => {\n  const path1 = \"scA0.gameList\";\n  const path2 = \"sc.A1.wishlist\";\n  const allVal = tools.getCtData(path1);\n\n  const { rendTrib, desMed, irRet, edu, prev, dep } = allVal;\nconsole.log({irRet});\n\n  const toNum = (str) => parseFloat((str || \"0\").replace(\",\", \".\"));\n\n  const totalDep = toNum(dep) * 2400;\n  const totalDed = toNum(desMed) + toNum(edu) + toNum(prev) + totalDep;\n  const calcBase = Math.max(0, toNum(rendTrib) - totalDed);\n\n  const tabelaIR = tools.getCtData('all.tabelaIR');\n  const faixaEncontrada = tabelaIR.find(faixa => calcBase <= faixa.limite);\n\nconst irDevido = Math.max(0, (calcBase * (faixaEncontrada.aliquota / 100)) - faixaEncontrada.deducao);\n\nconst resultado = toNum(irRet) - irDevido;\n\nlet finalResult;\nif (resultado >= 0) {\nconst res1 = \"Restituição: R$\" + resultado.toFixed(2);\n  console.log( res1 );\nfinalResult = res1;\n} else {\n  const res2 = \"Imposto a pagar: R$\" +  Math.abs(resultado).toFixed(2);\n  console.log( res2 );\nfinalResult = res2;\n}\nconsole.log({finalResult});\n\n const pass1 = { keyPath: [path2], value: [finalResult] };\n tools.functions.setVar({ args: '', pass: pass1 });\n}"}}